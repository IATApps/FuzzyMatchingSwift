machine:
  xcode:
    version: 7.3.1
test:
  override:
    - set -o pipefail && xcodebuild test -workspace Example/FuzzyMatchingSwift.xcworkspace -scheme FuzzyMatchingSwift-Example -sdk iphonesimulator9.3 ONLY_ACTIVE_ARCH=YES GCC_INSTRUMENT_PROGRAM_FLOW_ARCS=YES GCC_GENERATE_TEST_COVERAGE_FILES=YES -enableCodeCoverage YES clean test | xcpretty -c --report junit --output ${CIRCLE_TEST_REPORTS}/junit.xml
    - set -o pipefail && xcodebuild -workspace Example/FuzzyMatchingSwift.xcworkspace -scheme FuzzyMatchingSwift-Mac clean build | xcpretty -c
    - set -o pipefail && xcodebuild -workspace Example/FuzzyMatchingSwift.xcworkspace -scheme FuzzyMatchingSwift-watchOS -destination "generic/platform=watchOS" CODE_SIGNING_REQUIRED=NO CODE_SIGN_IDENTITY="" clean build | xcpretty -c
    - set -o pipefail && xcodebuild -workspace Example/FuzzyMatchingSwift.xcworkspace -scheme FuzzyMatchingSwift-tvOS -destination "platform=tvOS Simulator,name=Apple TV 1080p" clean build | xcpretty -c
    - bundle exec pod lib lint --quick --allow-warnings
  post:
    - bash <(curl -s https://codecov.io/bash)
